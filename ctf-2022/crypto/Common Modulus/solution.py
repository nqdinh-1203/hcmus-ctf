from Crypto.Util.number import *

n = 940061047059693065742464365398262241290752444593296314948723840987239387469764913664021089382604760907049885334590577314860916554550752975359061580689080975637149627979458252162242139992437951762426976029141077433612115406912666743372834576457824458577742602758119844851195717499428793873820904254960180498645299218489558001396142724155581131011952442161205616003413889960236864962336111449689491547233753988444491961040502733302646914098580935264369233961901429687897463085318462478798694213650043528323206659804739347694046845801624891964514443494432030197226375367769999723423825614691140826157179843912135902102618100375339881053822098122020338784103472866427381174021426801266226038766119917201876096168131606279625355183320752178151178235793754160544055841789643291994805251224629933006383353271028627499843469381481134987897624995581010887006341768508113961099068758989633225025237149126881625174171611308544710132735940083231275353757846729862558622250946870071354090953886676646304942869813597345335856922253999529023034310742894259931143925093322188122486609082443286732787287058630301075390782012419410450165156680374416556616492343702960524161907754958055291780815879125489307981570783771925758038055919601796543965899157
l = [3103306147,
     3734885419,
     2365514209,
     3527164493,
     3072050083,
     4131822407,
     2509876661,
     3783867877]
C = [33613942184753110906623350176637819858860556977699565094572811729073197437267631009705015676852484432226462980133611035664767242074024342715043520927205736622000604354443606593778186600378619027132150625144102170626158101246824762874072434183622063613123102326527959041190815121862735522960791896370900126983677728617131645923833599319795476994274952841241947754876641950530072430836609545230796818109934241064480790758498097593539307021875993521116268447691475546312171187325259666840483126284423948073667547390518127302662771775220711727699598798654211123838496930815794386900361773262688918153669123548616368982505448013852100536301984171459891102529785577273340564745434463893164862928301392143790105536850617464887062429548502446945174599689122837810165825437164741314536751729524801208015475189453565110845565718327515669663070521620233066307133606158069987646885194229305700374635897005784610260668176101811981131789764013793826621099288384488867433631053268313962580786995980548354249840042420432292872558383341213932068346052238727099880101326285195476834510227126306696223651368224376345054811248572763491781112447746888970227601396795118674280211044468213339777677383403124755462916045024941980611981006713005488080618268,
     314458942083429582857589471541548125497674512261639115936969928225440425459726609285684963278219570936018393010458588421643181326413090260570133346538168236016186724463804290309649506917868815554180516761224776426259273187882776600370913408123196701228964482347823607799961367551680830673024176953181639777075494587178324985553389865646238652238749966165129615332225083353701661414077166452961462436859404620343771022996735933167861558573746418975050041746211812010188742706981247604827066532050967562912812872809963510189286533656274271445226064790330882609014904744205067919614519368057794550566619527297397328950373282410963960042686185389716733702978759747670795265861501742685015378946928486236941289122274894219566791853045456263300851775850806202560949408973046705108418744745913546391963377441424384848757135614907315468973461886276925191143871254228153758092383647210624407044611131663159192333373732616375779013973533873370888025138388626587330000891486884296819171901961172578297747102338629702954015355557752389109002229707240996583688668479660348995714586293633954434245211794103566375315798936836455505523847057331719315079366079207411420657441577937194033970704861927504941229043311169168700266471142707226867412851093,
     219336423488188458024895744077550892979374499922570321262379268116672900991034738380722365032885240221017378858492041229120729510560982450483691114020000027006763531161650966586880060494861924927411767188939347446262464758390418209241675072860655859355669059691280088245152979977084379497852734990886163808191007193101115832784719087233402705939138834446269573804272008863864548620431948079080359530204488383468473826285350206611072926100854703234922227961282205457424475812041963789739135069407275349751393897353376805835197625665297575121393790910255887322666644533567194340638789569770549488128939629837920617493584448501894469903045108275068329166538537353292841160338995264230976076616059133450961573747259210524520636690681084641642593842382073257582703573659718759809692485974797901503253948240555771173255296565727306312282528629356579255005674226632350898750469750277454446910869289638828300395223321398161829312333268479905750160364997910262356415312436974452626440900458785586119337420803110931624595249747210991807348267015643939274598868717742037817769495793493783972143602524383186726215350863552913114088278500028452587896120453250573407373298779889074421998445559521097423581190562467019638412977118635261724576808284,
     490350340854874194412065947014943745089365854011409839035736488411481179465406049940761628115372532971014708059650707066888451270463864676500891515116345694783835424766191165214053080599977940076778471422269813885134930996013959141912567721220629539395323866797355024591822218230520068296797731871526101836051067909294824860964661310302193416764853780558652454593195367586605053646163153934811459621213979426415187761090895457725448360973781454736234494598320830979481809059931295326468046506837219292254223617145161829765931093196456088412562674277299326644074273459940231502275988749962289932801482750451982125460765568218022061521536707616797317216990450068916671796698673677119209924581377163858738635215656554005775248701149890815666193423478014112499835770671048860685035350423378348613074886506223118939641068017112581213563335953059931988077308962106430415138183399408381306705036941282476305971874477095067728224382638772453056765790516627633494742995349179856775812982185217435426145872381174703225348036769156914178594232853092852841582539503648145510853733386349945170158946448518570844878354248990651838868527743428923195932705463821716351520427443286257536360777379452048925279080370783997783933007118829063211797987228,
     535190187319199276486026042994054436862504810830519130132507482938244035167293475485268279977849490735414987000700033839477081715314539363557182737297443892339453479666820076711021557350127155057203193293649685523793321734226294984782887591299968423139376569135732988504444134097006257034252047480230597306012158238783242841071656826944364537248187067648059886535647023146290017712468033412554597574461861835977408850259110747825048629737315276854699480812888489709362900263785965272241952646458096287428101857570385700155115629929868329222244439070159220435200220029768394260969760614061947038801480305317912222979055081531465895294229379395715629701450980219675740586643785928069937336300623006821185678146570338821748654528935004086080200882336210990393244506911865947628282869162755832649527302769871318498939835241535218628831233387537563823224964819969435197417808008383493795506337882055625336113601152632692019538123931982210734767448785322067203188748331579400299280670852490313216887527855251380866571624485211210054602612578408692213205784785256852107543962044503325201239027547006242966527194020356706444665204802489433556994460420862456554286777192553037087774184812771069633589947259091174070580717223093607878356086986,
     9381675645309807116835472355158346705674632010666583960604243890549188472863864403133705177624264930627903292232250603668993875279986865602850881500650907514969625668304123720978891272634115054616774340067471575331551751293854076693530935780654609386794210952662149921697111220931592830324798497581245687490559250721008247681747606371762192348712029212216067012447436983316738741213815108394145901245392708467168624821492141344629457030227045264965268179041470923417932396764237699649871271714243544522766879805851624859452736745981672331815777180067386690848244741106707707887885762410427146500221905528915547576467602918663790063122320908100031290169674336204708372414159943230974772751785780294008377983922907608134999073760609823006284665441429770413737446069787091269575030230345959875150489790752702208709660416463105815933394798087469573773182607450193817829566718872163726527774082169111813128052231935188290174891148473722142019046099518693303519558340817553924821132640745542094860544235920449195565798657702525322340130443973786553827682570823788461852568826943805450838422877213625642422912867449340077814690938025616404539491600999176875409432320168729892315413781909608301930548827690643684546068504153520606988858948,
     173579604167644198520889722393295103366020666071944764815952699860447480863248885368220640138605927685363730299249722674081717817730623840294952781717160569933551214720347270682673788368023905429108509960648075052965715887613720421354013697696959415189432818852149988526447391869411644014021077586095714285853602783418893281155246647479257419578346658319910091569440408815562667134582613706221310437279762556654280891319087254780556972867306225516311608120815480706519060603965661471696847675468258816756351845830467278863405073119870283009764604169575576463239687479818450825675065119995284598821153503233055136708448585114806591803843720267749325017638541233389603335758197387086395747578967877493948951605608843079238544054906961424966030322267144533247368912549387152398160994050301850104564340288554483447094798157333854282587968252412901674936961284452048861887271725757007839502210022537156869875962915896530795691439929610581544681012001555541791981831914957045094384514929380033647200034187980190214412802883563320851964218944506155976289694126915064133643324245650540299675919182538599629799759734468528216425277581073311595311662677623870678676407984544015651207384587806095696470315276036522634268840655815120248765705398,
     240507708597150379943937893677465243062881306732847915733721580513762194767750548487923902101987749654797570409124406847443299354878591780546376147795708857058278427449757448657253697176965311032800606100925051009997203131480419520016955482285004892048603718427170701550236320972395649553220607988401263497067849495293036057050356185305475815213622200289048125164683973448732585330965353364352768960926223868355901084773492409417529020978498868686646450942615682886173060327329618674923550416292886873666402669432688691188239775518933640106218365996242046994465158581836249041566768060960497080971596769354567680609565584366383546099972643136403199455284966468596249068782257445400149417867951575888499884681670788410316095243571662064197151614643813229702723119077041993679632694963617686448461787043009604002456357144109122866992458133657703211113658440973142546394546561512982028715530706704149810198582619248029345189746584362985344127513446185380543153460334944856455355245156046546785030918834446264352226909450401358670693352991644273788633758784489344663813568835276753547202511716085598882119462696895434296354200645344974342958753926159089978933066703893610226279598674885018276244312815935108344800491753601685694368607293]


def reduce(l, C):
    s = pow(l[0], -1, l[1])
    r = (-l[0]*s + 1) // l[1]
    assert s*l[0] + r*l[1] == 1

    x = pow(C[0], s, n) * pow(C[1], r, n) % n
    assert pow(x, l[0], n) == C[0]
    assert pow(x, l[1], n) == C[1]
    return x


flag01 = reduce([l[1], l[0]], [C[0], C[1]])
flag02 = reduce([l[2], l[0]], [C[0], C[2]])
flag03 = reduce([l[3], l[0]], [C[0], C[3]])
flag04 = reduce([l[4], l[0]], [C[0], C[4]])
flag05 = reduce([l[5], l[0]], [C[0], C[5]])
flag06 = reduce([l[6], l[0]], [C[0], C[6]])
flag07 = reduce([l[7], l[0]], [C[0], C[7]])


flag012 = reduce([l[2], l[1]], [flag01, flag02])
flag013 = reduce([l[3], l[1]], [flag01, flag03])
flag014 = reduce([l[4], l[1]], [flag01, flag04])
flag015 = reduce([l[5], l[1]], [flag01, flag05])
flag016 = reduce([l[6], l[1]], [flag01, flag06])
flag017 = reduce([l[7], l[1]], [flag01, flag07])

flag0123 = reduce([l[3], l[2]], [flag012, flag013])
flag0124 = reduce([l[4], l[2]], [flag012, flag014])
flag0125 = reduce([l[5], l[2]], [flag012, flag015])
flag0126 = reduce([l[6], l[2]], [flag012, flag016])
flag0127 = reduce([l[7], l[2]], [flag012, flag017])

flag01234 = reduce([l[4], l[3]], [flag0123, flag0124])
flag01235 = reduce([l[5], l[3]], [flag0123, flag0125])
flag01236 = reduce([l[6], l[3]], [flag0123, flag0126])
flag01237 = reduce([l[7], l[3]], [flag0123, flag0127])

flag012345 = reduce([l[5], l[4]], [flag01234, flag01235])
flag012346 = reduce([l[6], l[4]], [flag01234, flag01236])
flag012347 = reduce([l[7], l[4]], [flag01234, flag01237])

flag0123456 = reduce([l[6], l[5]], [flag012345, flag012346])
flag0123457 = reduce([l[7], l[5]], [flag012345, flag012347])

flag01234567 = reduce([l[7], l[6]], [flag0123456, flag0123457])

print(flag01234567)
print(long_to_bytes(flag01234567))
